/** https://www.acmicpc.net/problem/14500 */

const [[n, m], ...board] = require('fs')
  .readFileSync(process.platform === 'linux' ? '/dev/stdin' : 'input.txt')
  .toString()
  .split('\n')
  .map((str) => str.split(' ').map(Number));

/**
 * Pseudo Code - 테트로미노 모양 정리 (총 19가지)
 *
 * Brute Force
 *
 * 1. 테트로미노는 기본 5가지 형태: I, O, L, Z, T
 *
 * 2. I (막대)
 *   - 가로: [0,0], [0,1], [0,2], [0,3]
 *   - 세로: [0,0], [1,0], [2,0], [3,0]
 *   → 총 2가지
 *
 * 3. O (정사각형)
 *   - 정사각형: [0,0], [0,1], [1,0], [1,1]
 *   → 총 1가지
 *
 * 4. L (ㄱ자 모양)
 *   - 기본 L 모양 회전: 4가지 (시계 방향 90도씩 회전)
 *   - 대칭 (좌우 반전) L 모양 회전: 4가지
 *   → 총 8가지
 *
 * 5. Z (지그재그)
 *   - Z 가로 형태: 2가지 (원형 + 대칭)
 *   - Z 세로 형태: 2가지 (원형 + 대칭)
 *   → 총 4가지
 *
 * 6. T (ㅗ자 모양)
 *   - ㅗ, ㅜ, ㅓ, ㅏ 네 방향
 *   → 총 4가지
 *
 * 🔢 총합: 2(I) + 1(O) + 8(L) + 4(Z) + 4(T) = 19가지 모양
 *
 * 이 19가지 블럭을 (i, j)를 기준으로 상대 좌표로 모두 하드코딩 후,
 * 보드 전체를 순회하면서 해당 블럭을 대입해보고 범위 내일 경우 합 계산
 */

const tetrominoShapes = [
  // I
  [
    [0, 0],
    [0, 1],
    [0, 2],
    [0, 3],
  ],
  [
    [0, 0],
    [1, 0],
    [2, 0],
    [3, 0],
  ],

  // O
  [
    [0, 0],
    [1, 0],
    [0, 1],
    [1, 1],
  ],

  // L
  [
    [0, 0],
    [1, 0],
    [2, 0],
    [2, 1],
  ],
  [
    [0, 0],
    [1, 0],
    [0, 1],
    [0, 2],
  ],
  [
    [0, 0],
    [0, 1],
    [1, 1],
    [2, 1],
  ],
  [
    [1, 0],
    [1, 1],
    [1, 2],
    [0, 2],
  ],
  [
    [0, 0],
    [0, 1],
    [0, 2],
    [1, 2],
  ],
  [
    [2, 0],
    [0, 1],
    [1, 1],
    [2, 1],
  ],
  [
    [0, 0],
    [1, 0],
    [1, 1],
    [1, 2],
  ],
  [
    [0, 0],
    [1, 0],
    [2, 0],
    [0, 1],
  ],

  // Z
  [
    [0, 0],
    [1, 0],
    [1, 1],
    [2, 1],
  ],
  [
    [0, 0],
    [0, 1],
    [1, 1],
    [1, 2],
  ],
  [
    [1, 0],
    [1, 1],
    [0, 1],
    [0, 2],
  ],
  [
    [0, 0],
    [1, 0],
    [1, -1],
    [2, -1],
  ],

  // T
  [
    [0, 0],
    [1, 0],
    [2, 0],
    [1, 1],
  ],
  [
    [0, 0],
    [0, 1],
    [0, 2],
    [1, 1],
  ],
  [
    [1, 0],
    [0, 1],
    [1, 1],
    [1, 2],
  ],
  [
    [1, 0],
    [0, 1],
    [1, 1],
    [2, 1],
  ],
];

let maxSum = 0;

for (let y = 0; y < n; y++) {
  for (let x = 0; x < m; x++) {
    for (const shape of tetrominoShapes) {
      let sum = 0;
      let isValid = true;

      for (const [dy, dx] of shape) {
        const ny = y + dy;
        const nx = x + dx;

        if (ny < 0 || ny >= n || nx < 0 || nx >= m) {
          isValid = false;
          break;
        }

        sum += board[ny][nx];
      }

      if (isValid) {
        maxSum = Math.max(maxSum, sum);
      }
    }
  }
}

console.log(maxSum);
